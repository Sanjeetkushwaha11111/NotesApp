package com.sanjeet.androidassignment.ui.characterlistimport androidx.lifecycle.LiveDataimport androidx.lifecycle.MutableLiveDataimport androidx.lifecycle.ViewModelimport androidx.lifecycle.viewModelScopeimport com.sanjeet.androidassignment.api.UseCaseResultimport com.sanjeet.androidassignment.data.characterModel.CharacterListimport com.sanjeet.androidassignment.data.repository.CharacterRepositoryimport kotlinx.coroutines.Dispatchersimport kotlinx.coroutines.launchimport kotlinx.coroutines.withContextimport timber.log.Timberclass CharachterViewModel(private val repository: CharacterRepository) : ViewModel() {    private val _characterLiveData = MutableLiveData<MutableList<CharacterList>>()    val characterLiveData: LiveData<MutableList<CharacterList>> = _characterLiveData    fun getCharacterList() {        viewModelScope.launch(Dispatchers.IO) {            val response = repository.getAllCharacters()            when (response) {                is UseCaseResult.Success -> {                    _characterLiveData.postValue(response.data.results!!)                    fetchEpisodeNames(response.data.results)                }                is UseCaseResult.Exception -> {                    Timber.e(">>>>>>>> getCharacterList api exception ${response.exception}")                }            }        }    }    private fun fetchEpisodeNames(characters: MutableList<CharacterList>) {        viewModelScope.launch(Dispatchers.IO) {            characters.forEach { characterWithEpisode ->                val episode = repository.fetchEpisodeForCharacter(characterWithEpisode.episode[0])                when (episode) {                    is UseCaseResult.Success -> {                        characterWithEpisode.episodeName = episode.data.name                    }                    is UseCaseResult.Exception -> {                        Timber.e(">>>>>>>> fetchEpisodeNames api exception ${episode.exception}")                    }                }                withContext(Dispatchers.Main) {                    _characterLiveData.postValue(characters)                }            }        }    }}